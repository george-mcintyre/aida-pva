<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AIDA-PVA: Deploying AIDA-PVA - A DevOps Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="aida-pva-logo-small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AIDA-PVA<span id="projectnumber">&#160;2.0</span>
   </div>
   <div id="projectbrief">AIDA-PVA is the latest version of the AIDA framework.  Built on top of EPICS 7 it enables client applications to programmatically access and manage any device or database on the SLAC Network using simple channel names.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Deploying AIDA-PVA - A DevOps Guide </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md2"></a>
Overview</h1>
<p >AIDA-PVA is made up of the following components:</p><ul>
<li>AIDA-PVA core<ul>
<li>AIDA-PVA.JAR<ul>
<li>launches the service providers integrating them into the EPICS PV-Access network</li>
</ul>
</li>
</ul>
</li>
<li>EPICS 7 that run on VMS (specially ported for AIDA-PVA)<ul>
<li>EPICS-PVACCESS-bp15.JAR</li>
<li>EPICS-PVDATA-bp15.JAR</li>
</ul>
</li>
<li>EPICS-7 Forwarder (specially built for AIDA-PVA)<ul>
<li>EPICS-FORWARDER.jar</li>
</ul>
</li>
<li>Individual shared libraries for each provider service loaded by AIDA-PVA jar<ul>
<li>SLCAPVA-DB.EXE</li>
<li>SLCAPVA-BPM.EXE</li>
<li>SLCAPVA-BUFFACQ.EXE</li>
<li>SLCAPVA-KLYSTRON.EXE</li>
<li>SLCAPVA-MAGNET.EXE</li>
<li>SLCAPVA-MODEL.EXE</li>
<li>SLCAPVA-MOSC.EXE</li>
<li>SLCAPVA-UTIL.EXE</li>
</ul>
</li>
<li>The updated Aida Shared Library<ul>
<li>AIDASHR.EXE</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md3"></a>
Running</h1>
<p >It is imperative that the Forwarder is started before any of the provider services. If the Forwarder dies then all of the other services must be shutdown and only restarted after starting the forwarder. This is because of a port contention that exists if the Forwarder finds any other provider service running when it starts up.</p>
<h1><a class="anchor" id="autotoc_md4"></a>
Running a Provider Service</h1>
<ul>
<li>Selection of Provider Service<ul>
<li>The AIDA-PVA jar loads the service provider shared library based on the following rules:<ul>
<li>An Environment Variable <code>AIDA_PVA_LIB_NAME</code><ul>
<li>fully qualified path name of library or</li>
<li>library name to search in the working directory and standard library locations <br  />
</li>
</ul>
</li>
<li>A property set on the launch commandline with the <code>-D</code> option named <code>aida.pva.lib.name</code><ul>
<li>fully qualified path name of library or</li>
<li>library name which will search in the working directory and standard library locations <br  />
</li>
</ul>
</li>
<li>A file in the working directory called <code>AIDA.EXE</code></li>
</ul>
</li>
<li>Note that the file extension is assumed to be <code>.EXE</code> if it is omitted</li>
<li>The AIDA-PVA jar loads the service provider shared library from based on:<ul>
<li>A property set on the launch commandline with the <code>-D</code> option named <code>java.library.path</code><ul>
<li>fully qualified path name or</li>
<li>relative path</li>
</ul>
</li>
<li>By default the standard library locations or working directory</li>
</ul>
</li>
</ul>
</li>
<li>Specifying the channels the provider will support<ul>
<li>The channels are configured in a yaml file. The default name for the file is <code>CHANNELS.YML</code></li>
<li>The AIDA-PVA jar loads the service provider's channels definition file based on the following rules:<ul>
<li>An Environment Variable <code>AIDA_PVA_CHANNELS_FILENAME</code><ul>
<li>fully qualified path name of channels file or</li>
<li>channels file name to search in the working directory <br  />
</li>
</ul>
</li>
<li>A property set on the launch commandline with the <code>-D</code> option named <code>aida.pva.channels.filename</code><ul>
<li>fully qualified path name of channels file or</li>
<li>channels file name to search in the working directory <br  />
</li>
</ul>
</li>
<li>A file in the working directory called <code>CHANNELS.YML</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md5"></a>
Example</h2>
<div class="fragment"><div class="line">MCCDEV&gt; lib</div>
<div class="line">Default:= DATA_DISK_SLC:[DEV.AIDA-PVA.LIB]</div>
<div class="line">MCCDEV&gt; java -jar &quot;-Djava.library.path=./&quot; &quot;-Daida.pva.lib.name=SLCAPVA-BPM&quot; AIDA-PVA.JAR</div>
<div class="line">Aida BPM Service Initialised</div>
<div class="line"> </div>
<div class="line">       db         88  88888888ba,           db</div>
<div class="line">      d88b        88  88      `&quot;8b         d88b</div>
<div class="line">     d8&#39;`8b       88  88        `8b       d8&#39;`8b</div>
<div class="line">    d8&#39;  `8b      88  88         88      d8&#39;  `8b                8b,dPPYba,   8b       d8  ,adPPYYba,</div>
<div class="line">   d8YaaaaY8b     88  88         88     d8YaaaaY8b     aaaaaaaa  88P&#39;    &quot;8a  `8b     d8&#39;  &quot;&quot;     `Y8</div>
<div class="line">  d8&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;8b    88  88         8P    d8&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;8b    &quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;  88       d8   `8b   d8&#39;   ,adPPPPP88</div>
<div class="line"> d8&#39;        `8b   88  88      .a8P    d8&#39;        `8b             88b,   ,a8&quot;    `8b,d8&#39;    88,    ,88</div>
<div class="line">d8&#39;          `8b  88  88888888Y&quot;&#39;    d8&#39;          `8b            88`YbbdP&quot;&#39;       &quot;8&quot;      `&quot;8bbdP&quot;Y8</div>
<div class="line">                                                                 88</div>
<div class="line">                                                                 88</div>
<div class="line"> </div>
<div class="line">AIDA-pva Channel Provider : SLCBpm</div>
<div class="line">Channels hosted:</div>
<div class="line">  [????????//BPMS, ???????:BPMS, ???????//BPMS, ????????:BPMS]</div>
</div><!-- fragment --><p >There are no health checks so in order to see if a service is running you'll have to check with the operating system.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Submitting jobs</h1>
<h1><a class="anchor" id="autotoc_md7"></a>
Restarting</h1>
<h1><a class="anchor" id="autotoc_md8"></a>
Verification of service status</h1>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
